<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>基础玩法组件 | MarketUI</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/market-ui/favicon.ico">
    <meta name="description" content="丰富、可靠的移动端营销互动组件库">
    
    <link rel="preload" href="/market-ui/assets/css/0.styles.5c00ebcc.css" as="style"><link rel="preload" href="/market-ui/assets/js/app.b0f98d71.js" as="script"><link rel="preload" href="/market-ui/assets/js/2.4653ba6f.js" as="script"><link rel="preload" href="/market-ui/assets/js/20.5998f42a.js" as="script"><link rel="prefetch" href="/market-ui/assets/js/10.9360c0e0.js"><link rel="prefetch" href="/market-ui/assets/js/11.e58cd9a1.js"><link rel="prefetch" href="/market-ui/assets/js/12.e802dc0b.js"><link rel="prefetch" href="/market-ui/assets/js/13.3a62693a.js"><link rel="prefetch" href="/market-ui/assets/js/14.fc7e3cd4.js"><link rel="prefetch" href="/market-ui/assets/js/15.30edd07e.js"><link rel="prefetch" href="/market-ui/assets/js/16.2d7941e9.js"><link rel="prefetch" href="/market-ui/assets/js/17.26d8c81d.js"><link rel="prefetch" href="/market-ui/assets/js/18.bda63d9b.js"><link rel="prefetch" href="/market-ui/assets/js/19.a879bb82.js"><link rel="prefetch" href="/market-ui/assets/js/21.1c927a39.js"><link rel="prefetch" href="/market-ui/assets/js/22.0564ee28.js"><link rel="prefetch" href="/market-ui/assets/js/23.b09f50f3.js"><link rel="prefetch" href="/market-ui/assets/js/24.b3eaa8e6.js"><link rel="prefetch" href="/market-ui/assets/js/25.e2db1096.js"><link rel="prefetch" href="/market-ui/assets/js/3.ab4c66a6.js"><link rel="prefetch" href="/market-ui/assets/js/4.0089d6d9.js"><link rel="prefetch" href="/market-ui/assets/js/5.630e8b01.js"><link rel="prefetch" href="/market-ui/assets/js/6.90e38288.js"><link rel="prefetch" href="/market-ui/assets/js/7.1a74eae0.js"><link rel="prefetch" href="/market-ui/assets/js/8.d8eed800.js"><link rel="prefetch" href="/market-ui/assets/js/9.4f42fb5d.js">
    <link rel="stylesheet" href="/market-ui/assets/css/0.styles.5c00ebcc.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="tuia-doc-container"><div class="tuia-doc-navbar" data-v-27201a4e><div class="tuia-doc-row" data-v-27201a4e><div class="tuia-doc-header__top" data-v-27201a4e><a href="/market-ui" class="tuia-doc-header__logo" data-v-27201a4e><img src="/market-ui/assets/img/logo.d6ecbd8a.png" alt data-v-27201a4e> <span data-v-27201a4e>MarketUI</span></a> <ul class="tuia-doc-header__top-nav" data-v-27201a4e><li data-v-27201a4e><div class="search-box" data-v-27201a4e><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div></li> <li class="tui-doc-header__top-nav-item" data-v-27201a4e><a href="https://github.com/tuia-fed/market-ui" target="_blank" data-v-27201a4e><img src="/market-ui/assets/img/github.9c166969.svg" alt data-v-27201a4e> <p data-v-27201a4e>Github</p></a></li></ul></div></div></div> <div class="tuia-doc-sidebar" style="top:60px;" data-v-03e8748a><div class="tuia-doc-sidebar__group" data-v-03e8748a><div class="tuia-doc-sidebar__title" data-v-03e8748a>引导</div> <div class="tuia-doc-sidebar__item" data-v-03e8748a><a href="/market-ui/guide/install" data-v-03e8748a>快速上手</a></div><div class="tuia-doc-sidebar__item" data-v-03e8748a><a href="/market-ui/guide/get-started" data-v-03e8748a>开发指南</a></div><div class="tuia-doc-sidebar__item" data-v-03e8748a><a href="/market-ui/guide/resolution" data-v-03e8748a>屏幕适配</a></div><div class="tuia-doc-sidebar__item" data-v-03e8748a><a href="/market-ui/guide/basic-rule" aria-current="page" class="router-link-exact-active router-link-active" data-v-03e8748a>基础玩法组件</a></div><div class="tuia-doc-sidebar__item" data-v-03e8748a><a href="/market-ui/guide/presets" data-v-03e8748a>变体与预设</a></div><div class="tuia-doc-sidebar__item" data-v-03e8748a><a href="/market-ui/guide/changelog" data-v-03e8748a>更新日志</a></div></div><div class="tuia-doc-sidebar__group" data-v-03e8748a><div class="tuia-doc-sidebar__title" data-v-03e8748a>基础玩法组件</div> <div class="tuia-doc-sidebar__item" data-v-03e8748a><div class="tuia-doc-sidebar__subtitle" data-v-03e8748a>大转盘系列</div></div><div class="tuia-doc-sidebar__item" data-v-03e8748a><a href="/market-ui/components/Wheel" data-v-03e8748a>大转盘</a></div><div class="tuia-doc-sidebar__item" data-v-03e8748a><a href="/market-ui/components/WheelFoundation" data-v-03e8748a>基座大转盘</a></div><div class="tuia-doc-sidebar__item" data-v-03e8748a><a href="/market-ui/components/SquareWheel" data-v-03e8748a>方形转盘</a></div><div class="tuia-doc-sidebar__item" data-v-03e8748a><a href="/market-ui/components/Wheel3D" data-v-03e8748a>3D转盘</a></div><div class="tuia-doc-sidebar__item" data-v-03e8748a><div class="tuia-doc-sidebar__subtitle" data-v-03e8748a>翻牌子系列</div></div><div class="tuia-doc-sidebar__item" data-v-03e8748a><a href="/market-ui/components/TurnCard" data-v-03e8748a>翻牌子</a></div><div class="tuia-doc-sidebar__item" data-v-03e8748a><a href="/market-ui/components/OpenBox" data-v-03e8748a>开礼盒</a></div><div class="tuia-doc-sidebar__item" data-v-03e8748a><a href="/market-ui/components/SkyLanterns" data-v-03e8748a>孔明灯</a></div><div class="tuia-doc-sidebar__item" data-v-03e8748a><a href="/market-ui/components/HitEgg" data-v-03e8748a>砸金蛋</a></div><div class="tuia-doc-sidebar__item" data-v-03e8748a><div class="tuia-doc-sidebar__subtitle" data-v-03e8748a>套圈系列</div></div><div class="tuia-doc-sidebar__item" data-v-03e8748a><a href="/market-ui/components/Ringtoss" data-v-03e8748a>套圈</a></div><div class="tuia-doc-sidebar__item" data-v-03e8748a><div class="tuia-doc-sidebar__subtitle" data-v-03e8748a>其他</div></div><div class="tuia-doc-sidebar__item" data-v-03e8748a><a href="/market-ui/components/ScratchCard" data-v-03e8748a>刮刮卡</a></div><div class="tuia-doc-sidebar__item" data-v-03e8748a><a href="/market-ui/components/Gashapon" data-v-03e8748a>扭蛋机</a></div></div><div class="tuia-doc-sidebar__group" data-v-03e8748a><div class="tuia-doc-sidebar__title" data-v-03e8748a>特殊玩法组件</div> <div class="tuia-doc-sidebar__item" data-v-03e8748a><a href="/market-ui/components/GiftRain" data-v-03e8748a>红包雨</a></div></div></div> <div class="tuia-doc-container" data-v-7177873e><div class="tuia-doc-content" style="min-height:-135px;" data-v-7177873e><section data-v-7177873e><div class="content__default"><h1 id="基础玩法组件"><a href="#基础玩法组件" class="header-anchor">#</a> 基础玩法组件</h1> <p>在深入分析现有的基础玩法组件后，可以将其大概分为两类：</p> <ul><li><strong>目标可控</strong>：我们可以控制目标命中哪个奖品，而玩家无法控制，如大转盘</li> <li><strong>目标不可控</strong>：玩家可以控制命中哪个目标（<em>不代表真实奖励</em>），而我们不可以控制，如翻牌子，部分套猫</li></ul> <p>这两类在后续的讨论中会有一些区别</p> <h1 id="基础玩法组件逻辑规范"><a href="#基础玩法组件逻辑规范" class="header-anchor">#</a> 基础玩法组件逻辑规范</h1> <p>在线上时我们可能会需要在玩法组件的各个阶段做一些事情，所以这边就通过规范组件的<strong>状态</strong>、<strong>方法</strong>和<strong>事件</strong>来让组件统一</p> <h2 id="状态"><a href="#状态" class="header-anchor">#</a> 状态</h2> <p>主要分为以下状态，<strong>有些状态可能就维持了一瞬间，有些可能是长时间存在的</strong>：</p> <ul><li><strong>初始化状态</strong>（0）：玩法组件默认状态</li> <li><strong>等待开始状态</strong>（1）：玩法组件初始化好之后，进入等待开始状态，比如大转盘缓慢转动等待玩法点击开始</li> <li><strong>开始状态</strong>（2）：玩家点了开始，组件开启启动，比如大转盘转速逐渐增大</li> <li><strong>等待结果状态</strong>（3）：组件一直播放动效，等待告知需要命中什么目标，比如大转盘一直在高速转动不停止。当然<strong>不可控组件没有这个状态，而是直接到下一个状态</strong></li> <li><strong>结果状态</strong>（4）：组件命中目标的过程，比如大转盘减速转动，并慢慢停在目标位置</li> <li><strong>奖品展示状态</strong>（5）：组件停在目标位置，比如页面可以根据大转盘的结果展示对应奖励/弹窗等</li> <li><strong>重置状态</strong>（6）：组件重置，为了可能有重置动效</li> <li><strong>禁用状态</strong>（100）：不可玩时的状态，比如按钮变为灰色</li></ul> <h2 id="事件"><a href="#事件" class="header-anchor">#</a> 事件</h2> <ul><li><strong>状态变化事件</strong>（stateChange）：有状态设定，就有状态变化事件</li> <li><strong>点击开始按钮事件</strong>（clickStart）：大转盘自带了开始按钮，点击按钮抛出该事件，注意，<strong>最好由外部决定是否真正开始，而不是玩法内部直接开始</strong></li></ul> <h2 id="方法"><a href="#方法" class="header-anchor">#</a> 方法</h2> <p>所有方法都设定为<strong>异步/Promise</strong>，都涉及到状态变化</p> <ul><li><strong>开始</strong>（start）：控制玩法组件开始，对于可控和不可控组件有不同的表现
<ul><li>可控组件：从<strong>等待开始状态</strong>切换为<strong>开始状态</strong>，异步结束时切换为<strong>等待结果状态</strong></li> <li>不可控组件：从<strong>等待开始状态</strong>切换为<strong>开始状态</strong>，过程中直接切换为<strong>结果状态</strong>，异步结束时切换为<strong>奖品展示状态</strong>。其实就是合并了后续的结束方法</li></ul></li> <li><strong>结束</strong>（stop）：<strong>仅可控组件拥有</strong>，控制玩法组件命中特定目标。其状态变化为从<strong>等待结果状态</strong>切换为<strong>结果状态</strong>，异步结束时切换为<strong>奖品展示状态</strong></li> <li><strong>重置</strong>（reset）：重置玩法组件，即从<strong>任意状态</strong>切换为<strong>重置状态</strong>，异步结束时切换为<strong>等待开始状态</strong></li> <li><strong>禁用</strong>（disable）：让玩法组件不可用，即从<strong>任意状态</strong>切换为<strong>禁用状态</strong></li></ul> <p>上面的方法中，<strong>开始</strong>与<strong>结束</strong>方法对于可控/不可控组件有所区别，下图可以更直观的看出区别</p> <p><img src="//yun.tuisnake.com/market-ui/53ef3aad-30fd-4f40-926c-1630db62fa57.png" alt="状态方法"></p> <h1 id="stateconstant"><a href="#stateconstant" class="header-anchor">#</a> StateConstant</h1> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">enum</span> StateConstant <span class="token punctuation">{</span>
  <span class="token comment">// 初始化状态</span>
  <span class="token constant">INIT</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token comment">// 等待开始状态</span>
  <span class="token constant">WAIT_START</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span>
  <span class="token comment">// 开始状态</span>
  <span class="token constant">START</span> <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span>
  <span class="token comment">// 等待结果状态</span>
  <span class="token constant">WAIT_END</span> <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">,</span>
  <span class="token comment">// 结果状态</span>
  <span class="token constant">END</span> <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">,</span>
  <span class="token comment">// 结果状态</span>
  <span class="token constant">PRIZE</span> <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">,</span>
  <span class="token comment">// 重置状态</span>
  <span class="token constant">RESET</span> <span class="token operator">=</span> <span class="token number">6</span><span class="token punctuation">,</span>
  <span class="token comment">// 不可用状态</span>
  <span class="token constant">DISABLE</span> <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div><p>可以如下引入</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> StateConstant <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@tuia/market-ui'</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> StateConstant <span class="token keyword">from</span> <span class="token string">'@tuia/market-ui/lib/constants/StateConstant'</span>
</code></pre></div><h1 id="basicbase"><a href="#basicbase" class="header-anchor">#</a> BasicBase</h1> <p>根据上述规范，所有基础玩法组件都继承自<code>BasicBase.ts</code></p> <h2 id="基本类型定义"><a href="#基本类型定义" class="header-anchor">#</a> 基本类型定义</h2> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token comment">// 状态变化事件参数</span>
<span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">StateChangeDataType</span> <span class="token punctuation">{</span>
  now<span class="token operator">:</span> StateConstant<span class="token punctuation">;</span>
  pre<span class="token operator">:</span> StateConstant<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="methods"><a href="#methods" class="header-anchor">#</a> Methods</h2> <table><thead><tr><th>名称</th> <th>入参</th> <th>出参</th> <th>说明</th></tr></thead> <tbody><tr><td>start</td> <td><em>any</em></td> <td><em>Promise</em></td> <td>开始方法</td></tr> <tr><td>stop</td> <td><em>any</em></td> <td><em>Promise</em></td> <td>结束方法</td></tr> <tr><td>reset</td> <td><em>any</em></td> <td><em>Promise</em></td> <td>重置方法</td></tr> <tr><td>disable</td> <td><em>any</em></td> <td><em>Promise</em></td> <td>禁用方法</td></tr> <tr><td>getState</td> <td>无</td> <td><a href="#stateconstant"><em>StateConstant</em></a></td> <td>获取状态方法</td></tr></tbody></table> <h2 id="events"><a href="#events" class="header-anchor">#</a> Events</h2> <table><thead><tr><th>名称</th> <th>参数</th> <th>说明</th></tr></thead> <tbody><tr><td>stateChange</td> <td><a href="#%E5%9F%BA%E6%9C%AC%E7%B1%BB%E5%9E%8B%E5%AE%9A%E4%B9%89"><em>StateChangeDataType</em></a></td> <td>状态变化事件</td></tr> <tr><td>clickStart</td> <td>无</td> <td>开始按钮被点击时触发</td></tr></tbody></table> <h2 id="state"><a href="#state" class="header-anchor">#</a> State</h2> <p>暴露了部分<code>computed</code>的数据，方便外部判断</p> <table><thead><tr><th>参数</th> <th>说明</th> <th>类型</th> <th>示例</th></tr></thead> <tbody><tr><td>isWaitStart</td> <td>是否为等待开始状态</td> <td><em>boolean</em></td> <td><code>true</code></td></tr> <tr><td>isDisable</td> <td>是否为禁用状态</td> <td><em>boolean</em></td> <td><code>false</code></td></tr></tbody></table></div> </section></div> <div class="tuia-doc-footer" data-v-7177873e><div data-v-7177873e><div class="footer" data-v-0cb7ee9a><span class="prefix" data-v-0cb7ee9a>上次更新：</span> <span class="time" data-v-0cb7ee9a></span></div></div></div></div> <div class="tuia-doc-preview" data-v-b0cc9f66><iframe src="/#/" frameborder="0" style="height:-90px;display:block;width:100%;" data-v-b0cc9f66></iframe></div></div><div class="global-ui"></div></div>
    <script src="/market-ui/assets/js/app.b0f98d71.js" defer></script><script src="/market-ui/assets/js/2.4653ba6f.js" defer></script><script src="/market-ui/assets/js/20.5998f42a.js" defer></script>
  </body>
</html>
