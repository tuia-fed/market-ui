(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{346:function(t,s,a){"use strict";a.r(s);var v=a(36),_=Object(v.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"基础玩法组件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#基础玩法组件"}},[t._v("#")]),t._v(" 基础玩法组件")]),t._v(" "),a("p",[t._v("在深入分析现有的基础玩法组件后，可以将其大概分为两类：")]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("目标可控")]),t._v("：我们可以控制目标命中哪个奖品，而玩家无法控制，如大转盘")]),t._v(" "),a("li",[a("strong",[t._v("目标不可控")]),t._v("：玩家可以控制命中哪个目标（"),a("em",[t._v("不代表真实奖励")]),t._v("），而我们不可以控制，如翻牌子，部分套猫")])]),t._v(" "),a("p",[t._v("这两类在后续的讨论中会有一些区别")]),t._v(" "),a("h1",{attrs:{id:"基础玩法组件逻辑规范"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#基础玩法组件逻辑规范"}},[t._v("#")]),t._v(" 基础玩法组件逻辑规范")]),t._v(" "),a("p",[t._v("在线上时我们可能会需要在玩法组件的各个阶段做一些事情，所以这边就通过规范组件的"),a("strong",[t._v("状态")]),t._v("、"),a("strong",[t._v("方法")]),t._v("和"),a("strong",[t._v("事件")]),t._v("来让组件统一")]),t._v(" "),a("h2",{attrs:{id:"状态"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#状态"}},[t._v("#")]),t._v(" 状态")]),t._v(" "),a("p",[t._v("主要分为以下状态，"),a("strong",[t._v("有些状态可能就维持了一瞬间，有些可能是长时间存在的")]),t._v("：")]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("初始化状态")]),t._v("（0）：玩法组件默认状态")]),t._v(" "),a("li",[a("strong",[t._v("等待开始状态")]),t._v("（1）：玩法组件初始化好之后，进入等待开始状态，比如大转盘缓慢转动等待玩法点击开始")]),t._v(" "),a("li",[a("strong",[t._v("开始状态")]),t._v("（2）：玩家点了开始，组件开启启动，比如大转盘转速逐渐增大")]),t._v(" "),a("li",[a("strong",[t._v("等待结果状态")]),t._v("（3）：组件一直播放动效，等待告知需要命中什么目标，比如大转盘一直在高速转动不停止。当然"),a("strong",[t._v("不可控组件没有这个状态，而是直接到下一个状态")])]),t._v(" "),a("li",[a("strong",[t._v("结果状态")]),t._v("（4）：组件命中目标的过程，比如大转盘减速转动，并慢慢停在目标位置")]),t._v(" "),a("li",[a("strong",[t._v("奖品展示状态")]),t._v("（5）：组件停在目标位置，比如页面可以根据大转盘的结果展示对应奖励/弹窗等")]),t._v(" "),a("li",[a("strong",[t._v("重置状态")]),t._v("（6）：组件重置，为了可能有重置动效")]),t._v(" "),a("li",[a("strong",[t._v("禁用状态")]),t._v("（100）：不可玩时的状态，比如按钮变为灰色")])]),t._v(" "),a("h2",{attrs:{id:"事件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#事件"}},[t._v("#")]),t._v(" 事件")]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("状态变化事件")]),t._v("（stateChange）：有状态设定，就有状态变化事件")]),t._v(" "),a("li",[a("strong",[t._v("点击开始按钮事件")]),t._v("（clickStart）：大转盘自带了开始按钮，点击按钮抛出该事件，注意，"),a("strong",[t._v("最好由外部决定是否真正开始，而不是玩法内部直接开始")])])]),t._v(" "),a("h2",{attrs:{id:"方法"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#方法"}},[t._v("#")]),t._v(" 方法")]),t._v(" "),a("p",[t._v("所有方法都设定为"),a("strong",[t._v("异步/Promise")]),t._v("，都涉及到状态变化")]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("开始")]),t._v("（start）：控制玩法组件开始，对于可控和不可控组件有不同的表现\n"),a("ul",[a("li",[t._v("可控组件：从"),a("strong",[t._v("等待开始状态")]),t._v("切换为"),a("strong",[t._v("开始状态")]),t._v("，异步结束时切换为"),a("strong",[t._v("等待结果状态")])]),t._v(" "),a("li",[t._v("不可控组件：从"),a("strong",[t._v("等待开始状态")]),t._v("切换为"),a("strong",[t._v("开始状态")]),t._v("，过程中直接切换为"),a("strong",[t._v("结果状态")]),t._v("，异步结束时切换为"),a("strong",[t._v("奖品展示状态")]),t._v("。其实就是合并了后续的结束方法")])])]),t._v(" "),a("li",[a("strong",[t._v("结束")]),t._v("（stop）："),a("strong",[t._v("仅可控组件拥有")]),t._v("，控制玩法组件命中特定目标。其状态变化为从"),a("strong",[t._v("等待结果状态")]),t._v("切换为"),a("strong",[t._v("结果状态")]),t._v("，异步结束时切换为"),a("strong",[t._v("奖品展示状态")])]),t._v(" "),a("li",[a("strong",[t._v("重置")]),t._v("（reset）：重置玩法组件，即从"),a("strong",[t._v("任意状态")]),t._v("切换为"),a("strong",[t._v("重置状态")]),t._v("，异步结束时切换为"),a("strong",[t._v("等待开始状态")])]),t._v(" "),a("li",[a("strong",[t._v("禁用")]),t._v("（disable）：让玩法组件不可用，即从"),a("strong",[t._v("任意状态")]),t._v("切换为"),a("strong",[t._v("禁用状态")])])]),t._v(" "),a("p",[t._v("上面的方法中，"),a("strong",[t._v("开始")]),t._v("与"),a("strong",[t._v("结束")]),t._v("方法对于可控/不可控组件有所区别，下图可以更直观的看出区别")]),t._v(" "),a("p",[a("img",{attrs:{src:"//yun.tuisnake.com/market-ui/53ef3aad-30fd-4f40-926c-1630db62fa57.png",alt:"状态方法"}})]),t._v(" "),a("h1",{attrs:{id:"stateconstant"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#stateconstant"}},[t._v("#")]),t._v(" StateConstant")]),t._v(" "),a("div",{staticClass:"language-typescript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-typescript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("enum")]),t._v(" StateConstant "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 初始化状态")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("INIT")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 等待开始状态")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("WAIT_START")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 开始状态")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("START")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 等待结果状态")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("WAIT_END")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 结果状态")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("END")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 结果状态")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("PRIZE")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 重置状态")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("RESET")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("6")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 不可用状态")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("DISABLE")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("100")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("可以如下引入")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" StateConstant "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'@tuia/market-ui'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" StateConstant "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'@tuia/market-ui/lib/constants/StateConstant'")]),t._v("\n")])])]),a("h1",{attrs:{id:"basicbase"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#basicbase"}},[t._v("#")]),t._v(" BasicBase")]),t._v(" "),a("p",[t._v("根据上述规范，所有基础玩法组件都继承自"),a("code",[t._v("BasicBase.ts")])]),t._v(" "),a("h2",{attrs:{id:"基本类型定义"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#基本类型定义"}},[t._v("#")]),t._v(" 基本类型定义")]),t._v(" "),a("div",{staticClass:"language-typescript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-typescript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 状态变化事件参数")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("interface")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("StateChangeDataType")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  now"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" StateConstant"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  pre"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" StateConstant"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("h2",{attrs:{id:"methods"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#methods"}},[t._v("#")]),t._v(" Methods")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("名称")]),t._v(" "),a("th",[t._v("入参")]),t._v(" "),a("th",[t._v("出参")]),t._v(" "),a("th",[t._v("说明")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("start")]),t._v(" "),a("td",[a("em",[t._v("any")])]),t._v(" "),a("td",[a("em",[t._v("Promise")])]),t._v(" "),a("td",[t._v("开始方法")])]),t._v(" "),a("tr",[a("td",[t._v("stop")]),t._v(" "),a("td",[a("em",[t._v("any")])]),t._v(" "),a("td",[a("em",[t._v("Promise")])]),t._v(" "),a("td",[t._v("结束方法")])]),t._v(" "),a("tr",[a("td",[t._v("reset")]),t._v(" "),a("td",[a("em",[t._v("any")])]),t._v(" "),a("td",[a("em",[t._v("Promise")])]),t._v(" "),a("td",[t._v("重置方法")])]),t._v(" "),a("tr",[a("td",[t._v("disable")]),t._v(" "),a("td",[a("em",[t._v("any")])]),t._v(" "),a("td",[a("em",[t._v("Promise")])]),t._v(" "),a("td",[t._v("禁用方法")])]),t._v(" "),a("tr",[a("td",[t._v("getState")]),t._v(" "),a("td",[t._v("无")]),t._v(" "),a("td",[a("a",{attrs:{href:"#stateconstant"}},[a("em",[t._v("StateConstant")])])]),t._v(" "),a("td",[t._v("获取状态方法")])])])]),t._v(" "),a("h2",{attrs:{id:"events"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#events"}},[t._v("#")]),t._v(" Events")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("名称")]),t._v(" "),a("th",[t._v("参数")]),t._v(" "),a("th",[t._v("说明")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("stateChange")]),t._v(" "),a("td",[a("a",{attrs:{href:"#%E5%9F%BA%E6%9C%AC%E7%B1%BB%E5%9E%8B%E5%AE%9A%E4%B9%89"}},[a("em",[t._v("StateChangeDataType")])])]),t._v(" "),a("td",[t._v("状态变化事件")])]),t._v(" "),a("tr",[a("td",[t._v("clickStart")]),t._v(" "),a("td",[t._v("无")]),t._v(" "),a("td",[t._v("开始按钮被点击时触发")])])])]),t._v(" "),a("h2",{attrs:{id:"state"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#state"}},[t._v("#")]),t._v(" State")]),t._v(" "),a("p",[t._v("暴露了部分"),a("code",[t._v("computed")]),t._v("的数据，方便外部判断")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("参数")]),t._v(" "),a("th",[t._v("说明")]),t._v(" "),a("th",[t._v("类型")]),t._v(" "),a("th",[t._v("示例")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("isWaitStart")]),t._v(" "),a("td",[t._v("是否为等待开始状态")]),t._v(" "),a("td",[a("em",[t._v("boolean")])]),t._v(" "),a("td",[a("code",[t._v("true")])])]),t._v(" "),a("tr",[a("td",[t._v("isDisable")]),t._v(" "),a("td",[t._v("是否为禁用状态")]),t._v(" "),a("td",[a("em",[t._v("boolean")])]),t._v(" "),a("td",[a("code",[t._v("false")])])])])])])}),[],!1,null,null,null);s.default=_.exports}}]);